\documentclass[11pt]{gsasthesis} % 10,11 and 12pt fonts allowed

%%%%%%%%%%%%%%%% PACKAGES YOU PROBABLY WANT %%%%%%%%%%%%%%%%
% Include packages you want. The gsasthesis style file already includes
% packages "setspace" and "tocbibind".

% Included in original document
\usepackage{etex} % extend the number of registers

% GSAS: "all margins should be at least 1 inch."
\usepackage[margin={1.0in}]{geometry}
% If you want asymmetric margins for two-sided documents, use the "twoside" option, as in
% \usepackage[top=1in,bottom=1.5in,left=1in,right=1.5in,twoside]{geometry} 
% The left and right options become inner and outer margins 
% The default horizontal latex margin ratio is 2:3. The default vertical top:bottom margin ratio is 2:3 also. 
% You can also set it directly by passing the hmarginratio option to the geometry package, as in
% \usepackage[top=1in,left=1in,vmarginratio=2:3,hmarginratio=2:5,twoside]{geometry}

% Appendix package. Not necessary, but it does make managing appendices easier
\usepackage[titletoc]{appendix}

%%%%%%%%%%%%%%%% PACKAGES MAY WANT %%%%%%%%%%%%%%%%

% sideways tables and figures
\usepackage{rotating}

% tables that spill over multiple pages
\usepackage{longtable}

% references
% \usepackage{natbib}

% fonts that are nicer than defaults
\usepackage[sc]{mathpazo}
\usepackage{courier}

% Use 8-bit encoding that has 256 glyphs, pretty please
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% babel is required for blindtext, which generates random text
\usepackage[english]{babel}
\usepackage{blindtext}

% Slightly tweak font spacing for aesthetics
\usepackage{microtype}

% You need the footmisc package with the stable option if you want to have footnotes inside section titles, 
% for example to say that a particular chapter has been co-authored with someone. 
% The multiple option ensures that there is a comma between two consecutive footnotes
\usepackage[stable,multiple]{footmisc}

% Nicer captions
\RequirePackage[font=small,format=plain,labelfont=bf,textfont=it]{caption}
\addtolength{\abovecaptionskip}{1ex}
\addtolength{\belowcaptionskip}{1ex}

%%%%%%%%%%%%%%%% MSE Packages %%%%%%%%%%%%%%%%
% Base packages
\usepackage{fancyhdr}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{geometry}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{setspace}
\usepackage{makecell}
\usepackage{amstext}
\usepackage{framed}
\usepackage{caption}
\usepackage{nicefrac}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{verbatim}
\usepackage{soul}
\usepackage{gensymb}

% Inline Graphics
\usepackage{graphicx,float,subfig, grffile}
\graphicspath{{../figs/}{../figs/web/}{../figs/integration_test/planets/}}

% Captions
\captionsetup[figure]{font=small}

% MSE Terminal environment for screenshots
\lstdefinestyle{Terminal}
{
    basicstyle=\fontsize{8}{10}\color{black}\ttfamily
}

% MSE Code snippets
\lstdefinestyle{CodeSnippet}
{
    basicstyle=\fontsize{10}{12}\color{black}\ttfamily
}
% MSE Macros
\newcommand{\tty}[1]{\texttt{#1}}

% Hypertext References
\usepackage{hyperref,color,textcomp}
\definecolor{webgreen}{rgb}{0,.35,0}
\definecolor{webbrown}{rgb}{.6,0,0}
\definecolor{RoyalBlue}{rgb}{0,0,0.9}
\definecolor{purp}{rgb}{0.6,0.3,0.9}
\hypersetup{
   colorlinks=true, linktocpage=true, pdfstartpage=3, pdfstartview=FitV,
   breaklinks=true, pdfpagemode=UseNone, pageanchor=true, pdfpagemode=UseOutlines,
   plainpages=false, bookmarksnumbered, bookmarksopen=true, bookmarksopenlevel=1,
   hypertexnames=true, pdfhighlight=/O,
   urlcolor=webbrown, linkcolor=RoyalBlue, citecolor=webgreen,
   pdfauthor={Michael S. Emanuel},
   pdfsubject={Harvard IACS Masters Thesis (May 2020)},
   pdfkeywords={},
   pdfcreator={pdfLaTeX},
   pdfproducer={LaTeX with hyperref}
}
\hypersetup{pdftitle={Kepler's Sieve}}


%%%%%%%%%%%%%%%% COMPULSORY FIELDS %%%%%%%%%%%%%%%%

\title{Kepler's Sieve: \\Learning Asteroid Orbits from Telescopic Observations} % needs to match title on DAC
\author{Michael S. Emanuel} % full name as it appears on your GSAS record, needs to match name on DAC
\degreename{Master of Science}
\degreefield{Data Science} % Official name of subject as listed in GSAS handbook
\department{Institute of Applied Computational Science} % official name of department
\degreemonth{May} % Month of Defense (i.e. month when DAC was signed)
\degreeyear{2020} % Year the DAC was signed
\principaladvisor{Professor Pavlos Protopapas}

% Optionally, you can add a second advisor, but you can't have three
\secondadvisor{Professor Christopher H. Rycroft}

% Macro definitions
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\mcL}{\mathcal{L}}
\newcommand{\hamiltonian}{\mathcal{H}}
\newcommand{\p}{\partial}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\xvec}{\vec{x}}
\newcommand{\uvec}{\vec{u}}
\newcommand{\bvec}{\vec{b}}

% MSE command to mark TODO items
\newcommand\todo[1]{\textbf{\textcolor{red}{#1}}}

\begin{document}

%%%%%%%%%%%%%%%% FRONTMATTER %%%%%%%%%%%%%%%%

\pagenumbering{roman} % GSAS wants roman page numbers for frontmatter

% the following four pages are required in that order. The first two pages are
% not allowed to have page numbers, this is taken care of in the class file.
\thesistitlepage
\copyrightpage
\begin{abstract}
% An abstract should be less than 350 words.
A novel method is presented to learn the orbits of asteroids from a large data set of telescopic observations.
The problem is formulated as a search over the six dimensional space of Keplerian orbital elements.
Candidate orbital elements are initialized by randomly choosing the six elements independently 
at random, either by sampling from a known asteroid or from uniformly distributed angles.
A statistical model describes the distribution of angular distances between the directions 
of observed detections to the predicted direction from the observatory site to a body with these orbital elements.
This model yields a log likelihood function, which attains large positive values when the candidate orbital elements are near 
to the elements of a real asteroid viewed many times in the data.
The candidate elements and the parameters describing the mixture distribution are jointly optimized using gradient descent.
Computations are performed quickly and efficiently on GPUs using the TensorFlow library.

The methodology of predicting the directions of telescopic detections is validated by demonstrating 
that out of approximately 5.69 million observations from the ZTF dataset,
3.75 million (65.71\%) fall within 2.0 arc seconds of the predicted directions of known asteroids.
The search process is validated in multiple stages.
First, I demonstrate that given an initial guess equal to a perturbation applied to the elements of asteroids present in the data,
the search process is able to successfully recover the true orbital elements to a high degree of precision.
Next, I demonstrate that a random initialization is able to converge to elements matching some known asteroids to high precision.
Finally, I use the search on observations that do not match any known asteroids.
I present orbital elements for [5] new, previously unknown asteroids.\\
\todo{Exact number of new asteroids presented}\\
All code for this project is publicly available on GitHub at \href{https://github.com/memanuel/kepler-sieve}{github.com/memanuel/kepler-sieve}.

\end{abstract}

% Center headings for table of contents, LOT, and LOF and make them smaller so that "Abstract", "Acknowledgments" and "Contents" all look alike. 
% Comment out if you want the default. If you want more control, use the "tocloft" package.
\renewcommand{\contentsname}{\protect\centering\protect\Large Contents}
\renewcommand{\listtablename}{\protect\centering\protect\Large List of Tables}
\renewcommand{\listfigurename}{\protect\centering\protect\Large List of Figures}

\tableofcontents % Table of contents

% The rest of the front matter: Lists of tables, figures, dedication and
% acknowledment is optional. Comment out whatever you don't like
% \listoftables
% \listoffigures
\begin{acknowledgments}
I would like to thank my advisor, Pavlos Protopapas, for suggesting this topic and for his consistent support, advice and encouragement. \\
I would like to thank Chris Rycroft, my secondary advisor, for guiding me through a paper in Applied Math 225 in which I explored
numerical integrators for solving solar system orbits.\\
I would like to thank Matt Holman and Matt Payne from the Center for Astrophics (CFA) for their advice on state of the art solar system integrators.\\
Most importantly, I would like to thank my wife Christie and my children Victor and Ren\'ee for their love and support.
The Covid-19 crisis struck just as my work on this thesis kicked into high gear.
It would not have been possible to complete it without extraordinary understanding and support from them.
\end{acknowledgments}
% \begin{dedication}
%   To my parents
% \end{dedication}


%%%%%%%%%%%%%%%% MAIN BODY %%%%%%%%%%%%%%%%
\pagenumbering{arabic} % reset page numbering and switch to arabic

% Introductory chapter. Comment out if you don't have an intro chapter, but I
% think most committees expect you to have one.
% Don't number the intro chapter, but add to to the table of contents
\addcontentsline{toc}{chapter}{Introduction}
\chapter*{Introduction}\label{ch:intro}
\input{intro}

% \chapter{Hook\footnote{Co-authored with my advisor}}\label{ch:1}
\chapter{Integrating the Solar System}\label{ch:1}
\input{chapter1}

\chapter{Predicting Directions from Positions}\label{ch:2}
\input{chapter2}

\chapter{Searching for Asteroids}\label{ch:3}
\input{chapter3}

%%%%%%%%%%%%%%%% BACK MATTER %%%%%%%%%%%%%%%%

% Put appendices, bibliography, and supplemental materials here

% The bibliography may be single spaced within each entry, but must be
% double-spaced between each entry. Most bibliography styles leave space between
% entries, so that shouldn't be a problem.
\begin{singlespacing}
% I like "References" better than "Bibliography"
\renewcommand{\bibname}{References}

% Any bibliohgraphy style that leaves space between entries is fine
% \bibliographystyle{acm}
% \bibliography{references}
\input{references}
\end{singlespacing}

% Appendices from all chapters should go at the end
% \input{appendix}

\end{document}
